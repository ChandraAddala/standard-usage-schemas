<productSchema xmlns="http://docs.rackspace.com/core/usage/schema"
               namespace="http://docs.rackspace.com/event/nova/host"
               serviceCode="CloudServersOpenStack"
               version="1" resourceTypes="HOST"
               type="UP DOWN">
    <description>
        UP / DOWN messages for Nova. The HOST resourceTypes is a physical machine upon which live multiple virtual servers.
    </description>
    <attribute name="collector" type="string"
               use="required">
        The hostname of the collector.
    </attribute>
    <attribute name="checkType" type="string"
               use="required" allowedValues="PING">
        The check type.
    </attribute>
    <attribute name="checkStatus" type="string"
               use="required" allowedValues="CRITICAL OK">
        The check status.
    </attribute>
    <attribute name="description" type="string"
               use="required">
        The description
    </attribute>

    <xpathAssertion test="if ($event/@type = 'UP') then $product/@checkStatus != 'CRITICAL' else true()" scope="entry">
        If message is UP type then checkStatus cannot be CRITICAL.
    </xpathAssertion>

    <xpathAssertion test="if ($event/@type = 'DOWN') then $product/@checkStatus != 'OK' else true()" scope="entry">
        If message is DOWN type then checkStatus cannot be OK.
    </xpathAssertion>
</productSchema>
